YUI.add("hermes-template-photo-list-photo-interaction",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i;r+='\n		<div class="extra-tools">\n			',i=n["if"].call(e,e.removeToolClass,{hash:{},inverse:l.noop,fn:l.program(2,p,t),data:t});if(i||i===0)r+=i;r+="\n			",i=n["if"].call(e,e.excludePeopleToolTitle,{hash:{},inverse:l.noop,fn:l.program(4,d,t),data:t});if(i||i===0)r+=i;return r+="\n		</div>\n	",r}function p(e,t){var r="",i;return r+='\n				<div class="extra-tool remove-photo ',(i=n.removeToolClass)?i=i.call(e,{hash:{},data:t}):(i=e.removeToolClass,i=typeof i===a?i.apply(e):i),r+=f(i)+'" data-id='+f((i=(i=e.photo,i==null||i===!1?i:i.id),typeof i===a?i.apply(e):i))+"></div>\n			",r}function d(e,t){var r="",i,s;return r+='\n				<div class="extra-tool exclude-person" data-id='+f((i=(i=e.photo,i==null||i===!1?i:i.id),typeof i===a?i.apply(e):i))+' title="',(s=n.excludePeopleToolTitle)?s=s.call(e,{hash:{},data:t}):(s=e.excludePeopleToolTitle,s=typeof s===a?s.apply(e):s),r+=f(s)+'"></div>\n			',r}function v(e,t){var r="",i;r+='\n		<div class="curator-tools">\n			',i=n.each.call(e,e.curatorTools,{hash:{},inverse:l.noop,fn:l.program(7,m,t),data:t});if(i||i===0)r+=i;return r+="\n			</ul>\n		</div>\n	",r}function m(e,t){var n="",r;return n+='\n				<li>\n					<i class="ui-icon-curator-'+f((r=e.name,typeof r===a?r.apply(e):r))+'"></i>\n				</li>\n			',n}function g(e,t){var n;return f((n=(n=e.photo,n==null||n===!1?n:n.title),typeof n===a?n.apply(e):n))}function y(e,t){var r,i;return i={hash:{intlName:"common.UNTITLED"},data:t},f((r=n.intlMessage||e.intlMessage,r?r.call(e,i):c.call(e,"intlMessage",i)))}function b(e,t){var r="",i,s;return r+=" ",s={hash:{intlName:"common.BY_YOU"},data:t},r+=f((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s))),r}function w(e,t){var r="",i,s;return r+=" ",s={hash:{intlName:"common.BY_USER",user:(i=(i=e.photo,i==null||i===!1?i:i.owner),i==null||i===!1?i:i.username)},data:t},r+=f((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s))),r}function E(e,t){var r="",i,s;r+="\n				",s=n["if"].call(e,(i=e.photo,i==null||i===!1?i:i.title),{hash:{},inverse:l.program(20,x,t),fn:l.program(18,S,t),data:t});if(s||s===0)r+=s;r+="\n				",s=n["if"].call(e,(i=(i=e.photo,i==null||i===!1?i:i.owner),i==null||i===!1?i:i.displayname),{hash:{},inverse:l.program(27,k,t),fn:l.program(22,T,t),data:t});if(s||s===0)r+=s;return r+="\n			",r}function S(e,t){var r="",i;return r+='\n					<a href="',(i=n.photoPageUrl)?i=i.call(e,{hash:{},data:t}):(i=e.photoPageUrl,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="title">'+f((i=(i=e.photo,i==null||i===!1?i:i.title),typeof i===a?i.apply(e):i))+"</a>\n				",r}function x(e,t){return'\n					<span class="title empty"> </span>\n				'}function T(e,t){var r="",i,s;r+='\n					<a href="'+f((i=(i=(i=e.photo,i==null||i===!1?i:i.owner),i==null||i===!1?i:i.url),typeof i===a?i.apply(e):i))+'" class="attribution">',s=n["if"].call(e,(i=e.photo,i==null||i===!1?i:i.isOwner),{hash:{},inverse:l.program(25,C,t),fn:l.program(23,N,t),data:t});if(s||s===0)r+=s;return r+="</a>\n				",r}function N(e,t){var r,i;return i={hash:{intlName:"common.BY_YOU"},data:t},f((r=n.intlMessage||e.intlMessage,r?r.call(e,i):c.call(e,"intlMessage",i)))}function C(e,t){var r,i;return i={hash:{intlName:"common.BY_USER",user:(r=(r=e.photo,r==null||r===!1?r:r.owner),r==null||r===!1?r:r.username)},data:t},f((r=n.intlMessage||e.intlMessage,r?r.call(e,i):c.call(e,"intlMessage",i)))}function k(e,t){return'\n					<span class="attribution empty"> </span>\n				'}function L(e,t){return'\n				<span class="title empty"> </span>\n				<span class="attribution empty"> </span>\n			'}function A(e,t){return" faved"}function O(e,t){return" fave"}function M(e,t){return" can-not-fave"}function _(e,t){var r="",i;return r+='<span class="icon-count">',(i=n.faveCount)?i=i.call(e,{hash:{},data:t}):(i=e.faveCount,i=typeof i===a?i.apply(e):i),r+=f(i)+"</span>",r}function D(e,t){var r="",i;return r+='<span class="icon-count">',(i=n.commentCount)?i=i.call(e,{hash:{},data:t}):(i=e.commentCount,i=typeof i===a?i.apply(e):i),r+=f(i)+"</span>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.helperMissing;s+='\n<div class="photo-list-photo-interaction">\n	<a class="overlay" href="',(o=n.photoPageUrl)?o=o.call(t,{hash:{},data:i}):(o=t.photoPageUrl,o=typeof o===a?o.apply(t):o),s+=f(o)+'"></a>\n	',o=n["if"].call(t,t.hasExtraFunctionality,{hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i});if(o||o===0)s+=o;s+="\n	",o=n["if"].call(t,t.curatorTools,{hash:{},inverse:l.noop,fn:l.program(6,v,i),data:i});if(o||o===0)s+=o;s+='\n	<div class="interaction-bar" title="',u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.title),{hash:{},inverse:l.program(11,y,i),fn:l.program(9,g,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.isOwner),{hash:{},inverse:l.program(15,w,i),fn:l.program(13,b,i),data:i});if(u||u===0)s+=u;s+='">\n		<div class="text">\n			',u=n["if"].call(t,t.displayTitleAndAttribution,{hash:{},inverse:l.program(29,L,i),fn:l.program(17,E,i),data:i});if(u||u===0)s+=u;s+='\n		</div>\n\n		<div class="tool">\n			<a href="',(u=n.photoPageUrl)?u=u.call(t,{hash:{},data:i}):(u=t.photoPageUrl,u=typeof u===a?u.apply(t):u),s+=f(u)+'" class="fave-area">\n				<i class="fave-star',u=n["if"].call(t,t.isFaved,{hash:{},inverse:l.program(33,O,i),fn:l.program(31,A,i),data:i});if(u||u===0)s+=u;u=n.unless.call(t,t.canFave,{hash:{},inverse:l.noop,fn:l.program(35,M,i),data:i});if(u||u===0)s+=u;s+='"></i>',u=n["if"].call(t,t.faveCount,{hash:{},inverse:l.noop,fn:l.program(37,_,i),data:i});if(u||u===0)s+=u;s+='\n			</a>\n		</div>\n\n		<div class="tool">\n			<a href="',(u=n.photoPageUrl)?u=u.call(t,{hash:{},data:i}):(u=t.photoPageUrl,u=typeof u===a?u.apply(t):u),s+=f(u)+'" class="comment-area">\n				<i class="comments"></i>',u=n["if"].call(t,t.commentCount,{hash:{},inverse:l.noop,fn:l
.program(39,D,i),data:i});if(u||u===0)s+=u;return s+="\n			</a>\n		</div>\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-list-photo-interaction",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-fluid-modal",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return" html-modal"}function h(e,t){return" subview-modal"}function p(e,t){return'<div class="close-x"></div>'}function d(e,t){var r="",i;r+='\n		<div class="head">\n			',i=n["if"].call(e,e.navBarView,{hash:{},inverse:l.program(10,m,t),fn:l.program(8,v,t),data:t});if(i||i===0)r+=i;return r+='\n			<div class="extra"></div>\n		</div>\n	',r}function v(e,t){return'\n				<div class="nav"></div>\n			'}function m(e,t){var r="",i;r+='\n				<div class="title">\n					',i=n["if"].call(e,e.title,{hash:{},inverse:l.program(13,y,t),fn:l.program(11,g,t),data:t});if(i||i===0)r+=i;return r+="\n				</div>\n			",r}function g(e,t){var r="",i;return r+="\n						",(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===u?i.apply(e):i),r+=a(i)+"\n					",r}function y(e,t){var r="",i,s;return r+="\n						",s={hash:{},data:t},r+=a((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,e.htmlTitle,s):f.call(e,"renderTrustedMarkup",e.htmlTitle,s)))+"\n					",r}function b(e,t){return" lines"}function w(e,t){var r="",i;r+='\n			<div class="content text-only ',i=n["if"].call(e,e.noScroll,{hash:{},inverse:l.noop,fn:l.program(18,E,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.showFooter,{hash:{},inverse:l.noop,fn:l.program(20,S,t),data:t});if(i||i===0)r+=i;return r+='">\n				',(i=n.textMessage)?i=i.call(e,{hash:{},data:t}):(i=e.textMessage,i=typeof i===u?i.apply(e):i),r+=a(i)+"\n			</div>\n		",r}function E(e,t){return" no-scroll"}function S(e,t){return" has-footer"}function x(e,t){var r="",i,s;r+='\n			<div class="content html-only ',i=n["if"].call(e,e.noScroll,{hash:{},inverse:l.noop,fn:l.program(18,E,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.showFooter,{hash:{},inverse:l.noop,fn:l.program(20,S,t),data:t});if(i||i===0)r+=i;return r+='">\n				',s={hash:{},data:t},r+=a((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,e.htmlMessage,s):f.call(e,"renderTrustedMarkup",e.htmlMessage,s)))+"\n			</div>\n		",r}function T(e,t){var r="",i;r+='\n			<div class="content subview ',i=n["if"].call(e,e.noScroll,{hash:{},inverse:l.noop,fn:l.program(18,E,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.showFooter,{hash:{},inverse:l.noop,fn:l.program(20,S,t),data:t});if(i||i===0)r+=i;return r+='"></div>\n		',r}function N(e,t){var r="",i,s;r+='\n		<div class="foot">\n			',s=n["if"].call(e,(i=e.buttons,i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(27,C,t),data:t});if(s||s===0)r+=s;return r+="\n		</div>\n	",r}function C(e,t){var r="",i,s;r+='\n			<div class="buttons">\n				',s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(28,k,t),data:t});if(s||s===0)r+=s;r+="\n				",s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.cancel),i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(33,O,t),data:t});if(s||s===0)r+=s;r+="\n				",s=n["if"].call(e,(i=e.buttons,i==null||i===!1?i:i.flavorText),{hash:{},inverse:l.noop,fn:l.program(35,M,t),data:t});if(s||s===0)r+=s;return r+="\n			</div>\n			",r}function k(e,t){var r="",i,s;r+='<button class="mini ',s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.isDangerous),{hash:{},inverse:l.noop,fn:l.program(29,L,t),data:t});if(s||s===0)r+=s;r+=' action"',s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.disabled),{hash:{},inverse:l.noop,fn:l.program(31,A,t),data:t});if(s||s===0)r+=s;return r+=">"+a((i=(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.label),typeof i===u?i.apply(e):i))+"</button>",r}function L(e,t){return"danger"}function A(e,t){return' disabled="disabled"'}function O(e,t){var n="",r;return n+='<button class="mini alt cancel">'+a((r=(r=(r=e.buttons,r==null||r===!1?r:r.cancel),r==null||r===!1?r:r.label),typeof r===u?r.apply(e):r))+"</button>",n}function M(e,t){var r="",i,s,o;r+='\n				<div class="flavor-text secondary',s=n.unless.call(e,(i=(i=e.buttons,i==null||i===!1?i:i.flavorText),i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(36,_,t),data:t});if(s||s===0)r+=s;return r+='">',o={hash:{},data:t},r+=a((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,(i=(i=e.buttons,i==null||i===!1?i:i.flavorText),i==null||i===!1?i:i.text),o):f.call(e,"renderTrustedMarkup",(i=(i=e.buttons,i==null||i===!1?i:i.flavorText),i==null||i===!1?i:i.text),o)))+"</div>\n				",r}function _(e,t){return" hidden"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=n.helperMissing,l=this;s+='<div class="modal',o=n["if"].call(t,t.htmlMessage,{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.subview,{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(o||o===0)s+=o;s+=" ",(o=n.classList)?o=o.call(t,{hash:{},data:i}):(o=t.classList,o=typeof o===u?o.apply(t):o),s+=a(o)+'">\n	',o=n["if"].call(t,t.showCancelX,{hash:{},inverse:l.noop,fn:l.program(5,p,i),data:i});if(o||o===0)s+=o;s+="\n	",o=n["if"].call(t,t.showHeader,{hash:{},inverse:l.noop,fn:l.program(7,d,i),data:i});if(o||o===0)s+=o;s+='\n	<div class="body',o=n["if"].call(t,t.showBodyLines,{hash:{},inverse:l.noop,fn:l.program(15,b,i),data:i});if(o||o===0)s+=o;s+='">\n		',o=n["if"].call(t,t.textMessage,{hash:{},inverse:l.noop,fn:l.program(17,w,i),data:i});if(o||o===0)s+=o;s+="\n		",o=n["if"].call(t,t.htmlMessage,{hash:{},inverse:l.noop,fn:l.program(22,x,i),data:i});if(o||o===0)s+=o;s+="\n		",o=n["if"].call(t,t.subview,{hash:{},inverse:l.noop,fn:l.program(24,T,i),data:i});if(o||o===0)s+=o;s+="\n	</div>\n	",o=n["if"].call(t,t.showFooter,{hash:{},inverse:l.noop,fn:l.program(26,N,i),data:i});if(o||o===0)s+=o;return s+="\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials
):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("fluid-modal-view",function(e,t){"use strict";var n,r;n={css:{destinationContainer:"body",closeX:".close-x",buttonCancel:"button.cancel",buttonAction:"button.action",navBarContent:".head .nav",subviewContent:".content.subview",modalContent:".body .content"},options:{}},r={supportsTransform:!1,modal:{height:0,width:0}},e.namespace("Views").FluidModal=e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.set("isActiveViewAgnostic",!0),this.alreadyShowingModal=e.OverlayManager.ModalOverlay.alreadyShowingModal(),this.alreadyShowingModal||e.OverlayManager.ModalOverlay.add(this),this},activate:function(){var t=this.get("container"),r=this;return this.get("showCancelX")&&this.registerEventHandler(t.one(n.css.closeX).on("click",e.bind(this.handleCancel,this))),this.get("showFooter")&&this.get("showCancelButton")&&this.get("showButtons")&&this.registerEventHandler(t.one(n.css.buttonCancel).on("click",e.bind(this.handleCancel,this))),this.get("showFooter")&&this.get("showActionButton")&&this.get("showButtons")&&this.registerEventHandler(t.one(n.css.buttonAction).on("click",e.bind(this.handleAction,this))),this.registerEventHandler(this.appContext.flapp.on("activeViewChange",function(e){r.close(e)})),this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){r.reposition()})),this.get("navBarView")&&r.get("navBarView").activate(),this.get("subview")&&(r.get("subview").activate(),r.registerEventHandler(r.get("subview").on("actionClick",e.bind(r.handleAction,r)))),this.fire("activated"),this},show:function(){return this.initialize().then(null,function(t){e.Flog.error("[fluid-modal-view] Error initializing modal: ",t)}),this.isClosed=!1,this.freeze(),e.fire("flickr:setKeyEventScope",this.getKeyEventScope()),this},freeze:function(){e.one("body").setStyles({overflow:"hidden"})},unfreeze:function(){e.one("body").setStyles({overflow:"visible"})},enableActionButton:function(){var e=this.get("container").one("button.action");e&&e.getAttribute("disabled")&&e.removeAttribute("disabled")},disableActionButton:function(){var e=this.get("container").one("button.action");e&&e.setAttribute("disabled",!0)},showFlavorText:function(){var e=this.get("container").one(".buttons .flavor-text");e&&e.removeClass("hidden")},hideFlavorText:function(){var e=this.get("container").one(".buttons .flavor-text");e&&e.addClass("hidden")},buildContainer:function(){if(!this.alreadyShowingModal){var t=this,i=e.one(n.css.destinationContainer),s;s={showCancelX:this.get("showCancelX"),title:this.get("title"),htmlTitle:this.get("htmlTitle"),navBarView:!!this.get("navBarView"),noScroll:this.get("noScroll"),textMessage:this.get("textMessage"),htmlMessage:this.get("message")?this.get("message"):this.get("htmlMessage"),subview:!!this.get("subview"),showBodyLines:this.get("showBodyLines"),hideModalOverlay:this.get("hideModalOverlay"),darkOverlay:this.get("darkOverlay"),showHeader:this.get("showHeader"),showFooter:this.get("showFooter"),buttons:{visible:this.get("showButtons"),action:{visible:this.get("showActionButton"),label:this.get("actionButtonLabel"),disabled:this.get("actionButtonDisabled"),isDangerous:this.get("actionButtonIsDangerous")},cancel:{visible:this.get("showCancelButton"),label:this.get("cancelButtonLabel")}},classList:this.get("classList")},this.get("buttonFlavorText")&&(s.buttons.flavorText={visible:this.get("showButtonFlavorText"),text:this.get("buttonFlavorText")}),this.setContainerHTML(this.templates("fluid-modal")(s)),r.modal.width=this.get("width"),r.modal.minWidth=this.get("minWidth"),r.modal.height=this.get("height"),this.get("navBarView")&&(this.get("navBarView").appContext=t.appContext,this.get("navBarView").initialize().then(function(e){e.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&(t.get("subview")&&e.details[0]==="navigation"?t.get("subview").fire.apply(t.get("subview"),["parentViewEvent"].concat(e.details)):t.get("subview")&&e.details[0]==="search"&&t.get("subview").fire.apply(t.get("subview"),["parentViewEvent"].concat(e.details)),t.fire.apply(t,e.details))}),t.get("container").one(n.css.navBarContent).appendChild(e.get("container")),t.get("subview")||t.activate()})),this.get("subview")?(this.get("subview").appContext=t.appContext,this.get("subview").set("isActiveViewAgnostic",!0),this.get("subview").initialize().then(function(e){t.on("parentViewEvent",function(t){t&&t.details&&t.details.length&&e.fire.apply(e,["parentViewEvent"].concat(t.details))}),e.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&(t.get("navBarView")&&e.details[0]==="backToList"&&t.get("navBarView").fire.apply(t.get("navBarView"),["parentViewEvent"].concat(e.details)),t.fire.apply(t,e.details))}),t.get("container").one(n.css.subviewContent).appendChild(e.get("container")),i&&(i.append(t.get("container")),t.reposition()),t.activate()},function(t){e.Flog.error("[fluid-modal-view] Error initializing modal subview: ",t)})):i&&(i.append(this.get("container")),this.reposition())}return this},reposition:function(){var t=this.get("container"),i=t.one(".modal"),s=e.one(e.config.win),o=parseInt(s.get("innerWidth"),10),u=parseInt(s.get("innerHeight"),10),a=r.modal.width?parseInt(r.modal.width,10):parseInt(i.getComputedStyle("width"),10),f,l,c=20,h,p={},d,v,m=i.one(".body"),g=0,y=this.get("showFooter")?parseInt(i.one(".foot").getComputedStyle("height"),10):0,b=0,w=parseInt(m.getComputedStyle("borderTopWidth"),10)+parseInt(m.getComputedStyle("borderBottomWidth"),10),E={};r.modal.height&&(g=parseInt(i.one(".head").getComputedStyle("height"),10),b=r.modal.height,i.get("showFooter")&&(y=parseInt(i.one(".foot").getComputedStyle("height"),10)),r.modal.height+g+y+4*c+w>=u&&(u<=700?b=u-g-y-w:b=u-g-y-4*c-w),i.setStyles({maxHeight:"none"}),this.get("fullWindow")?E.height=b+"px":this.get("maxHeight")&&(E.maxHeight=b+"px"),i.one(n.css.modalContent).setStyles(E)),f=this._getMiddleXPositionOfScreen(o,a),l=parseInt(i.getComputedStyle("height"
),10),d=i.getDOMNode().scrollHeight,v=i.getDOMNode().scrollWidth,h=this._getMiddleYPositionOfScreen(u,l),p={top:h+"px",left:f+"px",width:r.modal.width?a+"px":"",minWidth:r.modal.minWidth?r.modal.minWidth+"px":""},l+2*c>u||d>l+1||a+2*c>o||v>a?(u<=700&&r.modal.height?p.maxHeight=u-10+"px":(p.maxHeight=u-2*c+"px",p.overflow="auto"),p.top=e.DOM.docScrollY()+5+"px",p.maxWidth=o-2*c+"px"):(p.maxHeight="inherit",p.maxWidth="inherit",p.overflow="visible"),i.setStyles(p)},_getMiddleXPositionOfScreen:function(t,n){return Math.round(t/2)-Math.round(n/2)+e.DOM.docScrollX()},_getMiddleYPositionOfScreen:function(t,n){return Math.round(t/2)-Math.round(n/2)+e.DOM.docScrollY()},handleCancel:function(n){e.rapidTracker.beacon(t,"modalCancelClick"),this.fire("cancelClick",n),this.close(n)},handleAction:function(e){this.fire("actionClick",e),this.get("dismissOnActionClick")&&this.close(e)},close:function(t){e.fire("flickr:removeKeyEventScope",this.getKeyEventScope());var n=this.get("container");this.isClosed=!0,e.one("body").removeClass("scroll-fluid-modal"),this.get("subview")&&this.get("subview").destroy(),this.get("navBarView")&&this.get("navBarView").destroy(),n&&n.remove(!0),this.fire("close",t),this.destroy(),e.OverlayManager.ModalOverlay.remove(this)},getKeyEventScope:function(){return this.name+this._yuid},destructor:function(){this.unfreeze(),this.detachAll()}},{ATTRS:{showCancelX:{value:!0},showCancelButton:{value:!0},showBodyLines:{value:!1},showActionButton:{value:!0},hideModalOverlay:{value:!1},darkOverlay:{value:!1},actionButtonLabel:{valueFn:function(){return this.intlMessage({intlName:"common.OK"})}},actionButtonIsDangerous:{value:!1},cancelButtonLabel:{valueFn:function(){return this.intlMessage({intlName:"common.CANCEL"})}},actionButtonDisabled:{value:!1},showButtons:{value:!0},dismissOnOverlayClick:{value:!1},dismissOnActionClick:{value:!0},title:{value:""},htmlTitle:{value:""},navBarView:{value:null},message:{value:null},textMessage:{value:null},htmlMessage:{value:null},width:{value:0},minWidth:{value:0},height:{value:0},fullWindow:{value:!1},subview:{value:null},classList:{value:""},buttonFlavorText:{value:""},showButtonFlavorText:{value:!0},showHeader:{value:!0},showFooter:{value:!0},noScroll:{value:!1},maxHeight:{value:!0}}})},"@VERSION@",{requires:["flickr-view","fluid-css","hermes-template-fluid-modal","fluid-overlay-manager-view","flog"],optionalRequires:["fluid"],langBundles:["common"]});
YUI.add("photo-list-photo-interaction-view",function(e){"use strict";var t={css:{faveClickArea:".fave-area",removeFaveTool:"remove-fave",removePoolTool:"remove-group-pool",scotchPhotoTool:"scotch-photo"}},n=25,r=20,i=10,s=75;e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){var t=this.appContext.getViewer();return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),(!t.signedIn||e.nsid!==t.nsid)&&this.set("viewingSelf",!1),this.params=e,this},loadState:function(){var n=[],r=this.get("listModelParams");return n.push(this.appContext.getModel(this.get("engagementModelName"),this.get("id"))),r&&n.push(this.appContext.getModel(r.registryName,r.modelIdOrAttributes)),e.Promise.all(n).then(function(e){var n=e[0],r=e[1];this.set("engagement",n),this.extraFunctionality={},this.params.removeOwnFaves?this.get("model").getValue("isOwner")&&!this.get("viewingSelf")&&(this.extraFunctionality.removeToolClass=t.css.removeFaveTool):this.params.removePoolPhoto?this.get("model").getValue("isOwner")?this.extraFunctionality.removeToolClass=t.css.removePoolTool:r&&(r.getValue("group").getValue("isAdmin")||r.getValue("group").getValue("isModerator"))&&(this.extraFunctionality.removeToolClass=t.css.removePoolTool):this.params.scotchPhotos&&(this.extraFunctionality.removeToolClass=t.css.scotchPhotoTool),this.params.excludePeople&&(this.extraFunctionality.excludePeopleToolTitle=this.intlMessage({intlName:"common.HIDE_PHOTOS_FROM_PERSON"})),this.params.scotchPeople&&(this.extraFunctionality.excludePeopleToolTitle=this.godMessage({intlName:"explore.REMOVE_PERSON_FROM_EXPLORE"}))}.bind(this))},buildContainer:function(e){var t=this.get("engagement"),o=t.getValue("faveCount"),u=t.getValue("isFaved"),a=t.getValue("canFave"),f=t.getValue("commentCount"),l=55,c=!0;return o>=100?l+=n:o>=10?l+=r:o>0&&(l+=i),f>=100?l+=n:f>=10?l+=r:f>0&&(l+=i),this.get("layoutWidth")-l<s&&(c=!1),e=e||{},o=o<100?o:"99+",f=f<100?f:"99+",e.photo=this.get("model").toJSON(),e.photoPageUrl=this.get("photoPageUrl"),e.faveCount=o,e.isFaved=u,e.canFave=a,e.commentCount=f,e.displayTitleAndAttribution=c,e.hasExtraFunctionality=Object.keys(this.extraFunctionality).length>0,e.removeToolClass=this.extraFunctionality.removeToolClass,e.excludePeopleToolTitle=this.extraFunctionality.excludePeopleToolTitle,e.curatorTools=this.getCuratorTools(),this.setContainerHTML(this.templates("photo-list-photo-interaction")(e)),this},activate:function(){var e=this.get("engagement"),n=this.get("container");return this.get("engagement").getValue("canFave")&&(this.registerEventHandler(e.on("valuesChanged",this.faveStarChanged.bind(this))),this.registerEventHandler(n.delegate("click",this.faveStarClicked.bind(this),t.css.faveClickArea))),this},getCuratorTools:function(){if(!this.appContext.flipper.isFlipped("enable-curator-tools")||!this.appContext.getViewer().isInsecureGod)return null;var e=this.get("model"),t=e&&e.getValue("curation"),n=[];return t?(["is3MP","ownerCountryApproved","ownerFollowedByCurators","ownerAdded","ownerPassedOver"].forEach(function(e){t.getValue(e)&&n.push({name:e})}),n):null},faveStarClicked:function(t){var n=this.appContext.getViewer(),r=this.get("engagement"),i,s,o=this;n&&n.signedIn?this.get("isFaving")||(this.set("isFaving",!0),r.toggleFave(),r.remoteUpdate().then(function(){this.appContext.getModelRegistry("favorite-models").then(function(e){e.proxy(n.nsid).getValue("photoPageList").remove(o.get("model"))}),this.set("isFaving",!1)}.bind(this),function(e){e.code!==3&&r.toggleFave(),this.set("isFaving",!1)}.bind(this))):(i=new e.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_TITLE"}),htmlMessage:this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_MESSAGE"}),actionButtonLabel:this.intlMessage({intlName:"fave-view.SIGN_IN_AND_FAVE"}),cancelButtonLabel:this.intlMessage({intlName:"common.CANCEL"})}),i.on("actionClick",function(){s=e.URLHelper.getPhotoPage({photoId:r.getValue("id"),pathAlias:r.getValue("ownerNsid")}),e.SigninHelper.addPendingFave({id:r.getValue("id")},{postLoginUrl:e.url(s)})}),i.show()),t.halt()},faveStarChanged:function(e){(e.faveCount!==undefined||e.isFaved!==undefined||e.canFave!==undefined)&&this.buildContainer()},destructor:function(){}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(t,n){return e.TypeValidator.matches.photoId(t)}},model:{writeOnce:"initOnly"},listModelParams:{writeOnce:"initOnly"},photoPageUrl:{writeOnce:"initOnly"},engagement:{value:null},viewingSelf:{value:!0},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(t,n){return e.AttributeHelpers.validateString(t)}},layoutWidth:{validator:function(t,n){return e.AttributeHelpers.validateFloat(t)},setter:function(t){return e.AttributeHelpers.coerceFloat(t)||undefined},defaultFn:function(e){return 0}},isFaving:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-list-photo-interaction","photo-list-photo-interaction-css","type-validator","attribute-helpers","fluid-modal-view","url","flickrui-css"],optionalRequires:["fluid"],langBundles:["fave-view","common"]});
YUI.add("hermes-lang-fave-view",function(e,t){e.Intl.add("hermes/fave-view","en-US",{COULDNT_FAVE:["We couldn't fave at this time"],SIGN_IN_TO_FAVE:["You must be signed in to fave. Please sign in now."],LOADING_FAVES:["Loading Faves..."],UNFAVE_PHOTO:["Unfave this photo"],FAVE_PHOTO:["Fave this photo"],WHO_FAVED:["Who faved this photo"],SIGN_IN_BEFORE_FAVE_TITLE:["You found a photo to fave!"],SIGN_IN_BEFORE_FAVE_MESSAGE:["That's great. Just sign in to fave it."],SIGN_IN_AND_FAVE:["Sign in and fave"]})},"@VERSION@",{requires:["intl"]});
